<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>AccessOne - Inicio</title>
  <link rel="stylesheet" href="styles.css">
  <style>
  /* Index-specific header styles: make logo and header cohesive and visually balanced */
  .container { max-width: 760px; margin: 28px auto; padding: 22px; background: rgba(255,255,255,0.98); border-radius: 18px; }
  .header-accessone { text-align: center; padding: 28px 0 8px 0; display:flex; flex-direction:column; align-items:center; }
  /* Override logo-wrapper size specifically for index */
  .header-accessone .logo-wrapper { width: 112px; height: 112px; margin: 2px auto 12px auto; border-radius: 16px; }
  .header-accessone #logo-accessone { width: 88px; height: auto; }
  .header-accessone h1 { font-size: 1.9rem; margin: 6px 0 6px 0; color: var(--primary); font-weight:900; letter-spacing:0.6px; }
  .menu-buttons { display:flex; flex-direction:column; gap:12px; margin-top:18px }
  .menu-btn { display:block; padding:12px 18px; border-radius:12px; background:#fffbe7; color:#2E0060; text-decoration:none; border:2px solid #FFD400; font-weight:800; box-shadow: 0 4px 12px rgba(46,0,96,0.06); }
  .menu-btn:hover { transform: translateY(-2px); box-shadow: 0 8px 22px rgba(46,0,96,0.08); }
  .user-bar { display:flex; justify-content:space-between; align-items:center; padding:10px 12px; background:#fffbe7; border-radius:8px }
  @media (max-width: 600px) { .header-accessone .logo-wrapper { width:96px; height:96px } .header-accessone #logo-accessone { width:72px } .header-accessone h1 { font-size:1.3rem } }
  </style>
</head>
<body>
  <div class="container">
    <div class="header-accessone">
      <div class="logo-wrapper">
        <img id="logo-accessone" src="logo.png" alt="AccessOne Logo">
      </div>
      <h1>Bienvenido a AccessOne</h1>
    </div>

    <div id="user-bar" class="user-bar" style="display:none; margin-top:12px">
      <div id="user-email">usuario@dominio.com</div>
      <button id="logout-btn" class="menu-btn" style="width:auto;">Cerrar sesi√≥n</button>
    </div>

    <div id="menu" class="menu-buttons" style="display:none;">
      <a id="m-checklist" class="menu-btn" href="checklist.html">‚úÖ Check List</a>
      <a id="m-sai" class="menu-btn" href="https://accessone.alphaerpweb.mx/" target="_blank">üîó SAI</a>
      <a id="m-dashboard" class="menu-btn" href="dashboard.html">üìã Dashboard KPIs</a>
      <a id="m-vacantes" class="menu-btn" href="vacantes.html">üíº Vacantes por Zona</a>
      <a id="m-zonal" class="menu-btn" href="Zonal.html">üìç Vacantes por Zona (Zonal)</a>

  <a id="m-calificar-zonales" class="menu-btn" href="evaluacion-zonas.html" style="display:none;">üìù Calificar zonales</a>

      <a id="m-dashboard-fin" class="menu-btn" href="dashboard-financiero.html" style="display:none;">üí∞ Dashboard Financiero</a>
      <a id="m-gestion" class="menu-btn" href="gestionUsuarios.html" style="display:none;">üë§ Gesti√≥n de Usuarios</a>
    </div>

    <div style="margin-top:18px; font-size:0.9em; color:#666">&copy; AccessOne 2025</div>
  </div>

  <script type="module">
    import { auth, db } from './js/firebase-config.js';
    import { onAuthStateChanged, signOut } from 'https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js';
    import { doc, getDoc } from 'https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js';

    const userBar = document.getElementById('user-bar');
    const menu = document.getElementById('menu');
    const userEmailEl = document.getElementById('user-email');

    document.getElementById('logo-accessone').onclick = () => window.location.href = 'index.html';
    document.getElementById('logout-btn').onclick = async () => { await signOut(auth); window.location.href = 'login.html'; };

    onAuthStateChanged(auth, async user => {
      if (!user) return window.location.href = 'login.html';
      const email = (user.email || '').toLowerCase();
      userBar.style.display = '';
      menu.style.display = '';
      userEmailEl.textContent = email;

      // check admin flag
      let isAdmin = false;
      try {
        const snap = await getDoc(doc(db, 'users', user.uid));
        if (snap.exists()) {
          const d = snap.data();
          isAdmin = Boolean(d && (d.admin === true || d.isAdmin === true || d.admin || d.isAdmin));
        }
      } catch (err) { console.warn('users/{uid} read failed', err); }

      // admin: show financial dashboard
      if (isAdmin) document.getElementById('m-dashboard-fin').style.display = '';

      // csalcala special
      if (email === 'csalcala@accessone.com.mx') document.getElementById('m-gestion').style.display = '';
  // valonzo y jfernandez pueden calificar zonales
  if (email === 'valonzo@accessone.com.mx' || email === 'jfernandez@accessone.com.mx') {
    document.getElementById('m-calificar-zonales').style.display = '';
  }
    });
  </script>

  <script src="./js/logo-fix.js"></script>
</body>
</html>

